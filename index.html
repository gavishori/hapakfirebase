<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>יומן חפ"ק - לפיד</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A single-page, task-oriented application designed for efficient data entry and management, now without persistent storage (data is in-memory). The primary input area features report description, reporter, log type, and action buttons arranged horizontally on larger screens for compact and efficient interaction. Date and time inputs are hidden by default and only appear when editing an existing report. When visible for editing, the date input uses a native picker, and the time input allows direct manual typing. On smaller screens, these elements gracefully stack vertically to maintain usability. This consolidated input block is followed by the main content area displaying the data table. The table features date-based grouping with expand/collapse functionality (default collapsed for non-today dates) and global expand/collapse controls. Sorting is hybrid: new additions go to top (LIFO), while updates trigger a full chronological sort (date descending, then time descending) for the entire table. -->
    <!-- Visualization & Content Choices: Report Data -> Goal: Input/Manage -> Presentation: Consolidated HTML Form (for add/edit) & Grouped Collapsible HTML Table -> Interaction: Users input data via form. Add button is LIFO (visual). Update button triggers full chronological sort. Edit button reveals date/time inputs for modification. Date input is type="date". Time input is type="text" with manual input. Global/per-day buttons control collapse state. Textarea auto-resizes in add mode, fixed height in edit. Justification: Enhanced usability for data entry and review, clear visual organization, and precise adherence to complex sorting requirements without external dependencies for data persistence. Library/Method: Vanilla JS for DOM manipulation and state management, Tailwind CSS for styling and responsiveness. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-[#FDFBF7] text-[#4A443E]">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-5xl">

        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-[#6D5F53]">יומן חפ"ק - לפיד</h1>
        </header>

        <main class="bg-white rounded-xl shadow-lg p-6 ring-1 ring-[#EAE2D9]">
            <div class="controls-section mb-6 pb-6 border-b border-[#EAE2D9]">
                
                <div class="max-w-full mx-auto mb-6 p-4 bg-[#F8F5F1] rounded-lg shadow-inner">
                    <div class="flex flex-col sm:flex-row items-end gap-4">
                        <div class="flex-grow-[5] w-full sm:w-auto min-w-0">
                            <label for="generalTextInput" class="block mb-1 text-sm font-semibold text-[#6D5F53]">תיאור דיווח:</label>
                            <textarea id="generalTextInput" class="form-textarea w-full p-2 border rounded-md" rows="3" placeholder="פרטי דיווח קצרים..."></textarea>
                        </div>
                        
                        <div class="flex-shrink-0 w-full sm:w-auto"> <label for="filterReporter" class="block mb-1 text-sm font-semibold text-[#8C7A6B]">מדווח:</label>
                            <select id="filterReporter" class="form-select w-full p-2.5 bg-white border rounded-lg shadow-sm">
                                <option value="אורי">אורי</option>
                                <option value="שונית">שונית</option>
                                <option value="חיליק">חיליק</option>
                            </select>
                        </div>
                        
                        <div class="flex-shrink-0 w-full sm:w-auto"> <label for="filterLogType" class="block mb-1 text-sm font-semibold text-[#8C7A6B]">שיוך:</label>
                            <select id="filterLogType" class="form-select w-full p-2.5 bg-white border rounded-lg shadow-sm">
                                <option value="שגרה">שגרה</option>
                                <option value="שריפה">שריפה</option>
                                <option value="אחר">אחר</option>
                            </select>
                        </div>
                        
                        <div id="dateTimeInputsWrapper" class="flex-shrink-0 w-full sm:w-48 hidden">
                            <div class="flex flex-col gap-2">
                                <div>
                                    <label for="newDate" class="block mb-1 text-sm font-semibold text-[#6D5F53]">תאריך:</label>
                                    <input type="date" id="newDate" class="form-input w-full p-2 border rounded-md">
                                </div>
                                <div>
                                    <label for="newTime" class="block mb-1 text-sm font-semibold text-[#6D5F53]">שעה:</label>
                                    <input type="text" id="newTime" class="form-input w-full p-2 border rounded-md" placeholder="HH:MM" pattern="([01]?[0-9]|2[0-3]):[0-5][0-9]">
                                </div>
                            </div>
                        </div>

                        <div class="flex-shrink-0 w-full sm:w-auto flex flex-row sm:flex-col items-end gap-2"> <button id="mainActionBtn" class="btn-primary font-bold py-2 px-6 rounded-lg shadow w-full sm:w-auto">הזן</button>
                            <button id="cancelEditBtn" class="btn-secondary font-bold py-2 px-6 rounded-lg shadow w-full sm:w-auto hidden">ביטול</button>
                        </div>
                    </div>
                    <div id="inputErrorMessage" class="text-red-500 text-center mt-4 h-5"></div>
                </div>

            </div>

            <div class="table-container overflow-x-auto">
                <div class="flex justify-start gap-4 mb-4">
                    <button id="expandAllBtn" class="btn-secondary font-bold py-1.5 px-4 rounded-lg shadow text-sm">פתח הכל</button>
                    <button id="collapseAllBtn" class="btn-secondary font-bold py-1.5 px-4 rounded-lg shadow text-sm">צמצם הכל</button>
                </div>
                
                <table class="w-full min-w-full text-sm">
                    <thead>
                        <tr>
                            <th class="table-cell font-bold text-[#6D5F53]">דיווח</th>
                            <th class="table-cell font-bold text-[#6D5F53]">תאריך</th>
                            <th class="table-cell font-bold text-[#6D5F53]">שעה</th>
                            <th class="table-cell font-bold text-[#6D5F53]">שם המדווח</th>
                            <th class="table-cell font-bold text-[#6D5F53]">שיוך יומן</th>
                            <th class="table-cell font-bold text-[#6D5F53]">פעולות</th>
                        </tr>
                    </thead>
                    <tbody id="reportTableBody">
                        <tr id="empty-state">
                            <td colspan="6" class="table-cell text-center text-gray-500 py-8">לא נוספו דיווחים עדיין.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </main>

    </div>

    <!-- Custom JavaScript -->
    <script src="script.js" defer></script>
</body>
</html>
