:root{
  --bg:#0b0f19; --card:rgba(255,255,255,.06); --ink:#eef3ff; --muted:#9fb0c0;
  --brand:#6ee7ff; --accent:#ffd166; --ok:#4ade80; --danger:#ff5c8a; --border:rgba(255,255,255,.12);
  --shadow:0 18px 40px rgba(0,0,0,.45); --blur:12px;
}
[data-theme="light"]{
  --bg:#f5f7fb; --card:rgba(255,255,255,.9); --ink:#0e1116; --muted:#4b5b6b;
  --brand:#0066ff; --accent:#ff9d1b; --ok:#10a960; --danger:#e54063; --border:rgba(0,0,0,.08);
  --shadow:0 16px 28px rgba(0,0,0,.08); --blur:6px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:radial-gradient(1200px 500px at 80% -10%, #11203a 0%, var(--bg) 60%);color:var(--ink);
  font-family:Rubik,system-ui,-apple-system,Segoe UI,Roboto,Arial;overflow-x:hidden;direction:rtl}

a{color:var(--brand);text-decoration:none}
img{max-width:100%;display:block}
button{cursor:pointer}
.sr-only{position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;clip-path:inset(50%)}

.app{display:grid;grid-template-rows:auto 1fr;min-height:100vh}
.topbar{display:flex;align-items:center;gap:12px;padding:10px 14px;
  position:sticky;top:0;z-index:20;border-bottom:1px solid var(--border);
  background:linear-gradient(90deg, rgba(255,255,255,.04), rgba(255,255,255,.00));
  backdrop-filter:saturate(120%) blur(var(--blur));
}
.brand{display:flex;align-items:center;gap:8px}
.logo{width:36px;height:36px;object-fit:contain;filter:drop-shadow(0 4px 10px rgba(0,0,0,.35))}
.brand-text{font-weight:800;letter-spacing:.6px}
.spacer{flex:1}
.badge{border:1px solid var(--border);border-radius:999px;padding:6px 10px;background:rgba(255,255,255,.04)}

.btn{border:1px solid var(--border);background:rgba(255,255,255,.04);color:var(--ink);
  padding:12px 16px;border-radius:16px;transition:transform .06s ease, background .2s ease}
.btn:active{transform:scale(.98)}
.btn.primary{border-color:color-mix(in oklab, var(--brand) 50%, transparent);
  background:linear-gradient(180deg, color-mix(in oklab, var(--brand) 35%, transparent), transparent)}
.btn.subtle{background:transparent}
.btn.link{border:none;color:var(--brand);padding:8px 0}
.btn.danger{border-color:var(--danger);color:var(--danger)}
.btn.xl{font-size:1.06rem;padding:14px 18px;border-radius:18px}

.input, select, textarea{width:100%;background:rgba(255,255,255,.04);border:1px solid var(--border);
  color:var(--ink);padding:14px;border-radius:16px;outline:none}
.input.lg{font-size:1rem}
.input.xl{font-size:1.08rem}
textarea{min-height:100px}

.container{display:grid;grid-template-columns:1fr;gap:0;min-height:calc(100vh - 60px)}
.sidebar{padding:16px;border-bottom:1px solid var(--border);background:transparent;overflow:auto}
.content{padding:16px;overflow:auto}

.section-title{display:flex;align-items:center;gap:10px;margin:6px 0 12px}
.list-actions{display:flex;gap:10px;align-items:center;margin:10px 0}
.list-actions.sticky{position:sticky;top:64px;background:linear-gradient(180deg, rgba(11,15,25,.9), rgba(11,15,25,.2));
  padding:10px;border-radius:14px;backdrop-filter:blur(var(--blur));z-index:9}
.tabs{position:sticky;bottom:0;inset-inline:0;display:flex;gap:8px;
  background:linear-gradient(0deg, rgba(0,0,0,.2), rgba(0,0,0,0));
  border-top:1px solid var(--border);padding:10px;z-index:20}
.tabs button{flex:1;border:1px solid var(--border);border-radius:14px;padding:12px;background:rgba(255,255,255,.04)}
.tabs button.active{outline:2px solid color-mix(in oklab, var(--brand) 45%, transparent)}

.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}
.card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:16px;
  box-shadow:var(--shadow);backdrop-filter:blur(var(--blur)) saturate(120%)}
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
.list{display:flex;flex-direction:column;gap:10px}

table{width:100%;border-collapse:separate;border-spacing:0}
th,td{border-bottom:1px solid var(--border);padding:12px;text-align:right}
th{position:sticky;top:0;background:rgba(255,255,255,.04);backdrop-filter:blur(var(--blur))}

.pill{border:1px solid var(--border);padding:8px 12px;border-radius:999px;font-size:.9rem;background:rgba(255,255,255,.04)}
.muted{color:var(--muted)}

.leaflet-container{height:380px;border-radius:18px;border:1px solid var(--border);box-shadow:var(--shadow)}
.map-wrapper{position:relative}
.map-toolbar{position:absolute;left:12px;top:12px;display:flex;gap:8px;z-index:1200}

.toast{position:fixed;inset-inline-end:16px;inset-block-end:16px;background:rgba(20,24,34,.96);
  border:1px solid var(--border);border-radius:14px;padding:12px 16px;box-shadow:var(--shadow);display:none}
.toast.show{display:block}

.empty{display:grid;place-items:center;border:1px dashed var(--border);border-radius:20px;padding:26px;color:var(--muted)}

@media (min-width: 900px){
  .container{grid-template-columns:360px 1fr}
  .sidebar{border-inline-start:1px solid var(--border);border-bottom:none;height:calc(100vh - 60px)}
  .tabs{position:sticky;top:64px;bottom:auto;border-top:none;border-bottom:1px solid var(--border)}
}